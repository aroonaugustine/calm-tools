<?php if(!defined('BASE_DIR'))define('BASE_DIR',__DIR__.'/..'); if(!defined('LOG_DIR'))define('LOG_DIR','/srv/admin-tools/_logs'); @ini_set('display_errors',1); @ini_set('display_startup_errors',1); error_reporting(E_ALL); function ensure_dir($d){if(!is_dir($d))mkdir($d,0775,true);} ensure_dir(LOG_DIR); function h($s){return htmlspecialchars((string)$s,ENT_QUOTES,'UTF-8');} function read_json($f,$d=[]){if(!is_file($f))return $d; $j=file_get_contents($f); $x=json_decode($j,true); return is_array($x)?$x:$d;} function write_json($f,$d){ensure_dir(dirname($f)); file_put_contents($f,json_encode($d,JSON_PRETTY_PRINT|JSON_UNESCAPED_SLASHES));}