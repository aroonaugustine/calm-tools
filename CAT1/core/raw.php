<?php require_once __DIR__.'/bootstrap.php'; $id=preg_replace('/[^A-Za-z0-9_:-]/','',$_GET['id']??''); $fname=basename($_GET['file']??''); $path=LOG_DIR.'/'.$id.'/'.$fname; if(!$id||!$fname||!is_file($path)){ http_response_code(404); echo 'Not found'; exit; } $mime='application/octet-stream'; if(str_ends_with($fname,'.csv'))$mime='text/csv; charset=utf-8'; elseif(str_ends_with($fname,'.json'))$mime='application/json; charset=utf-8'; header('Content-Type: '.$mime); header('Content-Disposition: attachment; filename="'.$fname.'"'); readfile($path);